// Include base config first as it defines global defaults
includeConfig 'conf/base.config'

// Include specific configurations in proper order
includeConfig 'conf/modules.config'
includeConfig 'conf/params.config'    // Now includes both params and parameters
includeConfig 'conf/profiles.config'

// Define manifest for workflow metadata
manifest {
    name            = 'metaflow'
    contributors    = [
        [
            name: 'Minh-Quan Ton-Ngoc',
            affiliation: 'Oxford University Clinical Research Unit, Ho Chi Minh City, Vietnam',
            email: ['quantnm@oucru.org','minhquan.tdn.ct1619@gmail.com'],
            github: 'tnmquann',
            contribution: ['author'],
            orcid: '',
        ],
        [
            name: 'Si-Nguyen Mai-Thu',
            affiliation: 'Oxford University Clinical Research Unit, Ho Chi Minh City, Vietnam',
            email: 'nguyemts@oucru.org',
            github: 'singuyenmai',
            contribution: ['contributor'],
            orcid: '',
        ]
    ]
    homePage        = 'https://github.com/tnmquann/metaflow'
    description     = 'A modular Nextflow-based pipeline for efficient analysis of Illumina short-read metagenomic data, supporting both rapid read-level profiling and genome-resolved assembly, with a focus on accessibility, epidemiological surveillance, and reliable performance on resource-limited systems.'
    mainScript      = 'main.nf'
    defaultBranch   = 'main'
    nextflowVersion = '!>=25.04.2'
    version         = '1.0.1'
    doi             = ''
}

// Add repository configuration
repository {
    name = 'tnmquann/metaflow'
    url  = 'https://github.com/tnmquann/metaflow'
}

// Schema validation configuration
validation {
    enabled = true
    schema  = "${projectDir}/nextflow_schema.json"
    strict  = false  // Set to false to show warnings instead of errors for non-critical issues
}


// Trace settings
timeline {
    enabled = true
    file    = "${params.outdir}/pipeline_info/execution_timeline_${params.trace_report_suffix}.html"
}
report {
    enabled = true
    file    = "${params.outdir}/pipeline_info/execution_report_${params.trace_report_suffix}.html"
}
trace {
    enabled = true
    file    = "${params.outdir}/pipeline_info/execution_trace_${params.trace_report_suffix}.txt"
}
dag {
    enabled = true
    file    = "${params.outdir}/pipeline_info/pipeline_dag_${params.trace_report_suffix}.html"
}

