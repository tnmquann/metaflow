// Include base config first as it defines global defaults
includeConfig 'conf/base.config'

// Include specific configurations in proper order
includeConfig 'conf/modules.config'
includeConfig 'conf/params.config'    // Now includes both params and parameters
includeConfig 'conf/profiles.config'

// Test configuration
includeConfig 'conf/test.config'

// Define manifest for workflow metadata
manifest {
    name            = 'profiler_sourmash'
    author          = 'Ton Ngoc Minh Quan, Mai Thu Si Nguyen'
    homePage        = 'https://github.com/tnmquann/profiler_sourmash'
    description     = 'Metagenomics profiling pipeline using sourmash'
    mainScript      = 'main.nf'
    nextflowVersion = '>=23.04.0'
    version         = '1.0.0'
    doi            = ''  // Add if you have a DOI
}

// Add repository configuration
repository {
    name = 'tnmquann/profiler_sourmash'
    url  = 'https://github.com/tnmquann/profiler_sourmash'
}

// Schema validation configuration
validation {
    enabled = true
    schema  = "${projectDir}/nextflow_schema.json"
    strict  = false  // Set to false to show warnings instead of errors for non-critical issues
}

// Global default params, used in configs
params {
    // These are global defaults that can be overridden in params.config
    max_memory = 60.GB
    max_cpus = 20
    max_time = '24.h'

    // RGI default parameters
    rgi_aligner = 'kma'                    // Default aligner: kma, bowtie2, bwa
    rgi_include_wildcard = false           // Include wildcard variants
    rgi_include_other_models = false       // Include other model types (protein variant, rRNA, overexpression)
    rgi_bwt_args = null                    // Additional RGI bwt arguments
    rgi_preparecarddb_args = null          // Additional RGI preparecarddb arguments
    rgi_bwt_prefix = null                  // Custom prefix for RGI bwt outputs
    
    // RGI directory structure (can be overridden in params.config)
    rgi_dir = null                         // Will default to "${outdir}/RGI" if not set
    rgi_preparecarddb_dir = null           // Will default to "${outdir}/RGI/database" if not set
}

// Trace settings
trace {
    enabled = false
    file = 'pipeline_trace.txt'
    fields = 'task_id,name,status,exit,realtime,%cpu,peak_rss,peak_vmem,container'
}