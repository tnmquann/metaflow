params {
    // Input options
    input = null               // Path to input CSV file
    trimmed_fastq = null      // For backwards compatibility
    input_format = 'csv'      // Format of input: 'csv' or 'directory'
    
    // Directory structure
    base_dir = "/mnt/data1/quantnm/workflow/dump"
    workDir = "/mnt/data1/quantnm/workflow/profiler_sourmash"
    outdir = "${params.base_dir}/results"
    
    // Tool parameters
    ksize = 51
    sourmash_database = "/mnt/data1/quantnm/database/gtdb-rs214/gtdb-rs214-reps.k51.rocksdb"
    yacht_database = "/mnt/data1/quantnm/database/gtdb-rs214/gtdb-rs214-reps.k51_0.995_pretrained/gtdb-rs214-reps.k51_0.995_config.json"
    
    // Results directory structure
    results_dir = "${params.base_dir}/results"
    intermediate_dir = "${params.base_dir}/intermediate_files"
    sketch_dir = "${params.base_dir}/sketches"
    merged_seq_dir = "${params.base_dir}/merged_seq"
}

// Process resource configuration
process {
    cpus = 20
    memory = '60 GB'
    time = '24h'
    errorStrategy = { task.attempt <= 3 ? 'retry' : 'terminate' }
    maxRetries = 3

    withLabel: process_low {
        cpus = 2
        memory = '4 GB'
        conda = "${projectDir}/env/read_based.yaml"
    }
    withLabel: process_medium {
        cpus = 16
        memory = '32 GB'
        conda = "${projectDir}/env/read_based.yaml"
    }
    withLabel: process_high {
        cpus = 20
        memory = '60 GB'
        conda = "${projectDir}/env/read_based.yaml"
    }
}

// Executor configuration
executor {
    name = 'local'
    queueSize = 8
}