params {
    config_profile_name = 'Test profile'
    config_profile_description = 'Configuration for testing purposes'

    // Input parameters
    input = "/tmp/sample_temp.csv"
    input_format = 'csv'
    outdir = 'results/tests'

    // Hostile parameters
    hostile_reference = "${projectDir}/test_data/hostile"
    hostile_index = "genome.hg38.chr21_10000bp_region"
    hostile_ref_name = "genome.hg38.chr21_10000bp_region"
    
    // Database parameters
    sourmash_database = "${projectDir}/test_data/mockupdb_r226_k31.rocksdb"
    yacht_database = "/tmp/config_temp.json"
    ksize = 31

    // RGI parameters
    rgi_aligner = 'kma'                    // kma, bowtie2, bwa
    rgi_include_wildcard = false           // Include wildcard variants
    rgi_include_other_models = false       // Include other model types
    rgi_bwt_args = "--clean"                    // Additional RGI bwt arguments
    rgi_preparecarddb_args = null          // Additional RGI preparecarddb arguments
    rgi_bwt_prefix = null                  // Custom prefix for RGI bwt outputs

    // Directory structure parameters (required to avoid null file errors)
    merged_seq_dir = "${params.outdir}/Merged sequences"
    sketches_dir = "${params.outdir}/Sourmash - YACHT/sketches"
    yacht_results_dir = "${params.outdir}/Sourmash - YACHT"
    fastmultigather_dir = "${params.outdir}/Sourmash - YACHT"
    processed_results_dir = "${params.outdir}/Sourmash - YACHT"
    qc_raw_dir = "${params.outdir}/QC/Raw_reads"
    qc_trim_dir = "${params.outdir}/QC/Trimming"
    qc_rmhost_dir = "${params.outdir}/QC/Remove host genome"
    trim_dir = "${params.outdir}/Trimming"
    rmhost_dir = "${params.outdir}/Remove host genome"
    rgi_dir = "${params.outdir}/RGI"                    // RGI output directory
    rgi_preparecarddb_dir = null  // RGI database directory

    // Process configurations
    hostile_clean_args = '--debug'
    publish_dir_mode = 'copy'
}

profiles {
    test {
        process {
            publishDir = [
                mode: 'copy',
                saveAs: { filename -> filename }
            ]

            // Resource settings for testing
            cpus = 2
            memory = '6.GB'
            time = '2.h'
        }

        conda {
            enabled = true
            useMamba = false
            createTimeout = '1h'
            cacheDir = "${projectDir}/work/conda"
        }

        // Disable other container technologies
        docker.enabled = false
        singularity.enabled = false
        podman.enabled = false
        shifter.enabled = false
        charliecloud.enabled = false
        apptainer.enabled = false
    }

    // RGI test profiles
    test_rgi_kma {
        params {
            rgi_aligner = 'kma'
            rgi_include_wildcard = false
        }
    }

    test_rgi_wildcard {
        params {
            rgi_aligner = 'kma'
            rgi_include_wildcard = true
        }
    }

    test_rgi_bowtie2 {
        params {
            rgi_aligner = 'bowtie2'
            rgi_include_wildcard = true
        }
    }

    test_rgi_all_models {
        params {
            rgi_aligner = 'kma'
            rgi_include_wildcard = true
            rgi_include_other_models = true
        }
    }
}

// Executor settings
executor {
    name = 'local'
    queueSize = 4
}