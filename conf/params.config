params {
    // Copy control flags
    enable_copymergedseqs = true
    enable_copysketch = true
    enable_copyintermediate = true
    
    // Cleanup configuration
    cleanup = false
    cleanup_patterns = [
        'work',
        'intermediate_files',
        '.nextflow*',
        '.command.*',
        'process_tmp'
    ]
    
    // Optional email configuration
    email = null

    // Tool-specific arguments
    hostile_fetch_args = null
    hostile_clean_args = '--debug'
}

// Process-specific parameters
process {
    withName: 'SOURMASH_FASTMULTIGATHER' {
        ext.args = ''   // Custom arguments for sourmash fastmultigather
        ext.prefix = '' // Custom prefix for output files
    }

    withName: 'SOURMASH_MANYSKETCH' {
        ext.args_sourmash = '' // Custom arguments for sourmash manysketch
        ext.args_python = ''   // Custom arguments for Python script
    }

    withName: 'YACHT_RUN' {
        ext.args = '' // Custom arguments for yacht run
    }

    withName: 'MERGE_PAIREDENDSEQS' {
        ext.prefix = '' // Custom prefix for merged files
    }

    withName: 'PROCESS_READBASED_RESULTS' {
        ext.py_args_script1 = '' // Arguments for Python scripts
        ext.py_args_script2 = ''
        ext.py_args_script3 = ''
        ext.py_args_script4 = '--remove_unclassified --min_coverage 0.05'
    }

    withName: 'FASTQC_RAW|FASTQC_TRIMMED|FASTQC_RMHOST' {
        ext.args = ''
    }

    withName: 'FASTP' {
        ext.args = '--trim_front1 5 --trim_front2 5 --trim_tail1 1 --trim_tail2 1 --unqualified_percent_limit 30 --trim_poly_x --poly_x_min_len 8 --n_base_limit 5 --low_complexity_filter --length_required 65 --detect_adapter_for_pe --correction --overrepresentation_analysis --cut_right --cut_right_window_size 4 --cut_right_mean_quality 20'
    }

    withName: 'HOSTILE_FETCH' {
        ext.args = params.hostile_fetch_args ?: '--name human-t2t-hla'
    }

    withName: 'HOSTILE_CLEAN' {
        ext.args = params.hostile_clean_args ?: '--debug'
    }

    withName: 'RGI_BWT' {
    ext.args = { 
        def base_args = '--local -a ' + (params.rgi_aligner ?: 'kma')
        if (params.rgi_include_wildcard) base_args += ' --include_wildcard'
        if (params.rgi_include_other_models) base_args += ' --include_other_models'
        if (params.rgi_bwt_args) base_args += ' ' + params.rgi_bwt_args
        return base_args
        }
    }
    // Users can override this entire block in their custom config
    // custom.config
    // withName: 'RGI_BWT' {
    //     ext.args = '--local -a bowtie2 --include_wildcard --include_other_models --mapq 30 --coverage 0.8'
    // }
    withName: 'RGI_PREPARECARDDB' {
        ext.args = params.rgi_preparecarddb_args ?: ''
    }
}
